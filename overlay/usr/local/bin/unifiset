#!/bin/sh

enable_unifi_poller_service() {
    if [ "$poller_enabled" = "true" ]
    then
        sysrc -f /etc/rc.conf unifi_poller_enable="YES"
        service unifi-poller start
        echo "Make sure to configure unifi_poller using /usr/local/etc/unifi-poller/up.conf"
    elif [ "$poller_enabled" = "false" ]
    then
        if sysrc -c -q unifi_poller_enable
        then
            service unifi-poller stop
            sysrc -f /etc/rc.conf -x unifi_poller_enable
        fi
    else
        echo "Invalid unifi_poller_enable value. Accepted values: true/false"
        exit 1
    fi
}

if [ "$1" == "unifi_poller_enable" ]
then
    poller_enabled="$2"
    enable_unifi_poller_service
else
    echo "Unknwon option"
fi
